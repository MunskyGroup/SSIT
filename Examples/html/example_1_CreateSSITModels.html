<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>example_1_CreateSSITModels</title>
<meta name="generator" content="MATLAB 25.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2026-02-20">
<meta name="DC.source" content="example_1_CreateSSITModels.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">SSIT/Examples/example_1_CreateSSITModels</a>
</li>
<li>
<a href="#2">Section 2.1: Creating, Saving, and Loading Models in SSIT</a>
</li>
<li>
<a href="#3">Preliminaries:</a>
</li>
<li>
<a href="#4">Ex(1): Create a simple Bursting Gene model in SSIT</a>
</li>
<li>
<a href="#5">This model consists of 3 species:</a>
</li>
<li>
<a href="#6">There are four reactions, each with a unique rate parameter:</a>
</li>
<li>
<a href="#7">Ex(2): Copy the Bursting Gene Model above to a new model, 'STL1'.</a>
</li>
<li>
<a href="#8">Ex(3): Copy the 'STL1' model for 4-(gene)-state dynamics.</a>
</li>
<li>
<a href="#9">Ex.(4) Load and modify a pre-set SSIT model</a>
</li>
<li>
<a href="#10">Save the basic Bursting Gene model, simple STL1 model, and 4-state STL1</a>
</li>
<li>
<a href="#11">model for later use:</a>
</li>
</ul>
</div>
<h2 id="1">SSIT/Examples/example_1_CreateSSITModels</h2>
<pre class="codeinput">
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre>
<h2 id="2">Section 2.1: Creating, Saving, and Loading Models in SSIT</h2>
<pre class="codeinput">
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre>
<h2 id="3">Preliminaries:</h2>
<p>clear close all</p>
<pre class="codeinput">
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre>
<h2 id="4">Ex(1): Create a simple Bursting Gene model in SSIT</h2>
<h2 id="5">This model consists of 3 species:</h2>
<pre class="language-matlab">an <span class="string">inactive</span> <span class="string">gene</span> <span class="string">('offGene')</span>, an <span class="string">activated</span> <span class="string">gene</span> <span class="string">('onGene')</span>, and <span class="string">mRNA.</span>
</pre>
<h2 id="6">There are four reactions, each with a unique rate parameter:</h2>
<pre class="language-matlab">activation (<span class="string">'kon'</span>), inactivation (<span class="string">'koff'</span>), transcription (<span class="string">'kr'</span>),
and <span class="string">mRNA</span> <span class="string">degradation</span> <span class="string">('gr')</span>
</pre>
<pre class="codeinput">
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Create an SSIT instance and call it 'Model':</span>
Model = SSIT;

<span class="comment">% Set species names for bursting gene expression model:</span>
Model.species = {<span class="string">'offGene'</span>;<span class="string">'onGene'</span>;<span class="string">'mRNA'</span>};

<span class="comment">% Set initial condition:</span>
Model.initialCondition = [1;0;0];

<span class="comment">% Set stoichiometry of reactions:</span>
Model.stoichiometry = [-1,1,0,0;<span class="keyword">...</span>
                        1,-1,0,0;<span class="keyword">...</span>
                        0,0,1,-1];

<span class="comment">% Set propensity functions:</span>
Model.propensityFunctions = {<span class="string">'kon * offGene'</span>;<span class="string">'koff * onGene'</span>;<span class="keyword">...</span>
                             <span class="string">'kr * onGene'</span>;<span class="string">'dr * mRNA'</span>};

<span class="comment">% Set initial guesses for parameters:</span>
Model.parameters = ({<span class="string">'kon'</span>,0.2; <span class="string">'koff'</span>,0.2; <span class="string">'kr'</span>,10; <span class="string">'dr'</span>,5});

<span class="comment">% Print a summary of STL1 Model:</span>
Model.summarizeModel

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre>
<pre class="codeoutput">Species:
     offGene; IC = 1;  discrete stochastic
     onGene; IC = 0;  discrete stochastic
     mRNA; IC = 0;  discrete stochastic
 
Reactions:
  Reaction 1:
     s1: 1*offGene --&gt; 1*onGene
     w1: kon * offGene
  Reaction 2:
     s2: 1*onGene --&gt; 1*offGene
     w2: koff * onGene
  Reaction 3:
     s3: NULL --&gt; 1*mRNA
     w3: kr * onGene
  Reaction 4:
     s4: 1*mRNA --&gt; NULL
     w4: dr * mRNA
 
Model Parameters:
    {'kon' }    {[0.2000]}
    {'koff'}    {[0.2000]}
    {'kr'  }    {[    10]}
    {'dr'  }    {[     5]}

</pre>
<h2 id="7">Ex(2): Copy the Bursting Gene Model above to a new model, 'STL1'.</h2>
<p>The species, reactions, and stochiometries remain the same; however, a change is made to the propensity for the first reaction (gene activation) so that its rate is controlled by a time-varying MAPK input signal. As a result, new parameters must also be added.</p>
<pre class="codeinput">
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Create a copy of the simple Bursting Gene model from above:</span>
STL1 = Model;

<span class="comment">% Update propensity function for the gene activation reaction:</span>
STL1.propensityFunctions{2} = <span class="string">'onGene*koff/(1+Hog1)'</span>;

<span class="comment">% Define a simplified time-varying TF/MAPK input signal:</span>
STL1.inputExpressions = {<span class="string">'Hog1'</span>,<span class="string">'(a0+a1*exp(-r1*t)*(1-exp(-r2*t))*(t&gt;0))'</span>};

<span class="comment">% Add the new parameters from the TF/MAPK input signal:</span>
STL1.parameters = ({<span class="string">'kon'</span>,0.2; <span class="string">'koff'</span>,0.2; <span class="string">'kr'</span>,10; <span class="string">'dr'</span>,5;<span class="keyword">...</span>
                    <span class="string">'a0'</span>,5; <span class="string">'a1'</span>,10; <span class="string">'r1'</span>,0.004; <span class="string">'r2'</span>,.01});

<span class="comment">% Print a summary of STL1 Model:</span>
STL1.summarizeModel

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre>
<pre class="codeoutput">Species:
     offGene; IC = 1;  discrete stochastic
     onGene; IC = 0;  discrete stochastic
     mRNA; IC = 0;  discrete stochastic
 
Reactions:
  Reaction 1:
     s1: 1*offGene --&gt; 1*onGene
     w1: kon * offGene
  Reaction 2:
     s2: 1*onGene --&gt; 1*offGene
     w2: onGene*koff/(1+Hog1)
  Reaction 3:
     s3: NULL --&gt; 1*mRNA
     w3: kr * onGene
  Reaction 4:
     s4: 1*mRNA --&gt; NULL
     w4: dr * mRNA
 
Input Signals:
     Hog1(t) = (a0+a1*exp(-r1*t)*(1-exp(-r2*t))*(t&gt;0))
 
Model Parameters:
    {'kon' }    {[0.2000]}
    {'koff'}    {[0.2000]}
    {'kr'  }    {[    10]}
    {'dr'  }    {[     5]}
    {'a0'  }    {[     5]}
    {'a1'  }    {[    10]}
    {'r1'  }    {[0.0040]}
    {'r2'  }    {[0.0100]}

</pre>
<h2 id="8">Ex(3): Copy the 'STL1' model for 4-(gene)-state dynamics.</h2>
<pre class="codeinput">
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Create a copy of the STL1 model from above:</span>
STL1_4state = STL1;

<span class="comment">% Set species names for STL1_4state:</span>
STL1_4state.species = {<span class="string">'g1'</span>;<span class="string">'g2'</span>;<span class="string">'g3'</span>;<span class="string">'g4'</span>;<span class="string">'mRNA'</span>};

<span class="comment">% Set initial condition:</span>
STL1_4state.initialCondition = [1;0;0;0;0];

<span class="comment">% Set stoichiometry of reactions:</span>
STL1_4state.stoichiometry = [-1,1,0,0,0,0,0,0,0,0,0;<span class="keyword">...</span><span class="comment">   % gene state 1</span>
                              1,-1,-1,1,0,0,0,0,0,0,0;<span class="keyword">...</span><span class="comment"> % gene state 2</span>
                              0,0,1,-1,-1,1,0,0,0,0,0;<span class="keyword">...</span><span class="comment"> % gene state 3</span>
                              0,0,0,0,1,-1,0,0,0,0,0;<span class="keyword">...</span><span class="comment">  % gene state 4</span>
                              0,0,0,0,0,0,1,1,1,1,-1]     <span class="comment">% mRNA</span>
                 <span class="comment">% Reactions: 1,2,3,4,5,6,7,8,9,10,11</span>

<span class="comment">% Add a lag to the time-varying TF/MAPK input signal:</span>
STL1_4state.inputExpressions = <span class="keyword">...</span>
    {<span class="string">'Hog1'</span>,<span class="string">'A*(((1-(exp(1)^(-r1*(t-t0))))*exp(1)^(-r2*(t-t0)))/(1+((1-(exp(1)^(-r1*(t-t0))))*exp(1)^(-r2*(t-t0)))/M))^n*(t&gt;t0)'</span>};

<span class="comment">% Set propensity functions:</span>
STL1_4state.propensityFunctions = {<span class="keyword">...</span>
          <span class="string">'k12*g1'</span>;<span class="string">'(max(0,k21o*(1-k21i*Hog1)))*g2'</span>;<span class="keyword">...</span>
          <span class="string">'k23*g2'</span>;<span class="string">'k32*g3'</span>; <span class="string">'k34*g3'</span>;<span class="string">'k43*g4'</span>;<span class="keyword">...</span>
          <span class="string">'kr1*g1'</span>;<span class="string">'kr2*g2'</span>;<span class="string">'kr3*g3'</span>;<span class="string">'kr4*g4'</span>;<span class="string">'dr*mRNA'</span>};

<span class="comment">% Add the new parameters for the 4 state model:</span>
STL1_4state.parameters = ({<span class="string">'t0'</span>,3.17; <span class="string">'k12'</span>,78; <span class="string">'k21o'</span>,1.92e+05;<span class="keyword">...</span>
    <span class="string">'k21i'</span>,3200; <span class="string">'k23'</span>,0.402; <span class="string">'k34'</span>,7.8; <span class="string">'k32'</span>,1.62;<span class="keyword">...</span>
    <span class="string">'k43'</span>,2.28; <span class="string">'dr'</span>,0.294; <span class="string">'kr1'</span>,4.68e-02; <span class="string">'kr2'</span>,0.72;<span class="keyword">...</span>
    <span class="string">'kr3'</span>, 59.4; <span class="string">'kr4'</span>, 3.24; <span class="string">'r1'</span>,4.14e-03; <span class="string">'r2'</span>,0.426;<span class="keyword">...</span>
    <span class="string">'A'</span>,9.3e+09; <span class="string">'M'</span>,6.4e-04; <span class="string">'n'</span>,3.1});

<span class="comment">% Print a summary of STL1 Model:</span>
STL1_4state.summarizeModel

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre>
<pre class="codeoutput">
STL1_4state = 

  SSIT with properties:

                       parameters: {8&times;2 cell}
                          species: {5&times;1 cell}
                    stoichiometry: [5&times;11 double]
              propensityFunctions: {4&times;1 cell}
                 inputExpressions: {1&times;2 cell}
             customConstraintFuns: {}
                       fspOptions: [1&times;1 struct]
                      sensOptions: [1&times;1 struct]
                       ssaOptions: [1&times;1 struct]
                       pdoOptions: [1&times;1 struct]
                   fittingOptions: [1&times;1 struct]
                 initialCondition: [5&times;1 double]
                     initialProbs: 1
                      initialTime: 0
                            tSpan: [0 0.5000 1 1.5000 2 &hellip; ] (1&times;21 double)
                   solutionScheme: 'FSP'
                    odeIntegrator: 'ode23s'
                  solutionSchemes: {}
            modelReductionOptions: [1&times;1 struct]
                          dataSet: []
                        useHybrid: 0
                    hybridOptions: [1&times;1 struct]
              propensitiesGeneral: []
           propensitiesGeneralODE: []
          propensitiesGeneralMean: []
       propensitiesGeneralMeanJac: []
       propensitiesGeneralMoments: []
    propensitiesGeneralMomentsJac: []
             propensityFilePrefix: 'Default'
                        Solutions: []
                      description: {'Add model description here'}
                         GUIProps: []
                   fspConstraints: [1&times;1 struct]
                   pars_container: [8&times;1 containers.Map]

Species:
     g1; IC = 1;  discrete stochastic
     g2; IC = 0;  discrete stochastic
     g3; IC = 0;  discrete stochastic
     g4; IC = 0;  discrete stochastic
     mRNA; IC = 0;  discrete stochastic
 
Reactions:
  Reaction 1:
     s1: 1*g1 --&gt; 1*g2
     w1: k12*g1
  Reaction 2:
     s2: 1*g2 --&gt; 1*g1
     w2: (max(0,k21o*(1-k21i*Hog1)))*g2
  Reaction 3:
     s3: 1*g2 --&gt; 1*g3
     w3: k23*g2
  Reaction 4:
     s4: 1*g3 --&gt; 1*g2
     w4: k32*g3
  Reaction 5:
     s5: 1*g3 --&gt; 1*g4
     w5: k34*g3
  Reaction 6:
     s6: 1*g4 --&gt; 1*g3
     w6: k43*g4
  Reaction 7:
     s7: NULL --&gt; 1*mRNA
     w7: kr1*g1
  Reaction 8:
     s8: NULL --&gt; 1*mRNA
     w8: kr2*g2
  Reaction 9:
     s9: NULL --&gt; 1*mRNA
     w9: kr3*g3
  Reaction 10:
     s10: NULL --&gt; 1*mRNA
     w10: kr4*g4
  Reaction 11:
     s11: 1*mRNA --&gt; NULL
     w11: dr*mRNA
 
Input Signals:
     Hog1(t) = A*(((1-(exp(1)^(-r1*(t-t0))))*exp(1)^(-r2*(t-t0)))/(1+((1-(exp(1)^(-r1*(t-t0))))*exp(1)^(-r2*(t-t0)))/M))^n*(t&gt;t0)
 
Model Parameters:
    {'t0'  }    {[    3.1700]}
    {'k12' }    {[        78]}
    {'k21o'}    {[    192000]}
    {'k21i'}    {[      3200]}
    {'k23' }    {[    0.4020]}
    {'k34' }    {[    7.8000]}
    {'k32' }    {[    1.6200]}
    {'k43' }    {[    2.2800]}
    {'dr'  }    {[    0.2940]}
    {'kr1' }    {[    0.0468]}
    {'kr2' }    {[    0.7200]}
    {'kr3' }    {[   59.4000]}
    {'kr4' }    {[    3.2400]}
    {'r1'  }    {[    0.0041]}
    {'r2'  }    {[    0.4260]}
    {'A'   }    {[9.3000e+09]}
    {'M'   }    {[6.4000e-04]}
    {'n'   }    {[    3.1000]}

</pre>
<h2 id="9">Ex.(4) Load and modify a pre-set SSIT model</h2>
<pre class="codeinput">
<span class="comment">% Several simple models are already coded in SSIT and can be quickly</span>
<span class="comment">% loaded and modified. Below are currently available SSIT models (2025).</span>
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% ModelChoice = 'BirthDeath';      % One species problem</span>
<span class="comment">% ModelChoice = 'CentralDogma';    % Two species problem</span>
<span class="comment">% ModelChoice = 'BurstingGene';    % Two species problem</span>
<span class="comment">% ModelChoice = 'ToggleSwitch';    % Two species problem</span>
<span class="comment">%                                    (non-linear toggle switch)</span>
<span class="comment">% ModelChoice = 'ToggleSwitch2';   % Two species problem</span>
<span class="comment">% ModelChoice = 'CentralDogmaTV';  % Two species problem (mRNa and protein)</span>
<span class="comment">%                                    with time-varying transcription rate</span>
<span class="comment">% ModelChoice = 'Repressilator';               % Three species problem</span>
<span class="comment">% ModelChoice = 'BurstingSpatialCentralDogma'; % Four species problem</span>
<span class="comment">%                                            (gene state, nuclear mRNa,</span>
<span class="comment">%                                            cytoplasmic mRNA, and protein)</span>
ModelChoice = <span class="string">'RepressilatorGenes'</span>; <span class="comment">% Nine species problem</span>

<span class="comment">% Let's load one of the pre-existing SSIT models:</span>
RepGenes_Model = SSIT(ModelChoice);

<span class="comment">% View a summary of the 'RepressilatorGenes' model:</span>
RepGenes_Model.summarizeModel
</pre>
<pre class="codeoutput">Species:
     x1; IC = 1;  discrete stochastic
     x2; IC = 0;  discrete stochastic
     x3; IC = 30;  discrete stochastic
     x4; IC = 0;  discrete stochastic
     x5; IC = 1;  discrete stochastic
     x6; IC = 0;  discrete stochastic
     x7; IC = 0;  discrete stochastic
     x8; IC = 1;  discrete stochastic
     x9; IC = 0;  discrete stochastic
 
Reactions:
  Reaction 1:
     s1: 1*x1 + 3*x6 --&gt; 1*x2
     w1: kb*x1*x6*(x6-1)/2*(x6-2)/6
  Reaction 2:
     s2: 1*x2 --&gt; 1*x1 + 3*x6
     w2: ku*x2
  Reaction 3:
     s3: NULL --&gt; 1*x3
     w3: kn0*x2+kn1*x1
  Reaction 4:
     s4: 1*x3 --&gt; NULL
     w4: g*x3
  Reaction 5:
     s5: 1*x4 + 3*x9 --&gt; 1*x5
     w5: kb*x4*x9*(x9-1)/2*(x9-2)/6
  Reaction 6:
     s6: 1*x5 --&gt; 1*x4 + 3*x9
     w6: ku*x5
  Reaction 7:
     s7: NULL --&gt; 1*x6
     w7: kn0*x5+kn1*x4
  Reaction 8:
     s8: 1*x6 --&gt; NULL
     w8: g*x6
  Reaction 9:
     s9: 3*x3 + 1*x7 --&gt; 1*x8
     w9: kb*x7*x3*(x3-1)/2*(x3-2)/6
  Reaction 10:
     s10: 1*x8 --&gt; 3*x3 + 1*x7
     w10: ku*x8
  Reaction 11:
     s11: NULL --&gt; 1*x9
     w11: kn0*x8+kn1*x7
  Reaction 12:
     s12: 1*x9 --&gt; NULL
     w12: g*x9
 
Model Parameters:
    {'kn0'}    {[   0]}
    {'kn1'}    {[  25]}
    {'kb' }    {[2000]}
    {'ku' }    {[  10]}
    {'g'  }    {[   1]}

</pre>
<h2 id="10">Save the basic Bursting Gene model, simple STL1 model, and 4-state STL1</h2>
<h2 id="11">model for later use:</h2>
<pre class="codeinput">saveNames = unique({<span class="string">'Model'</span>
    <span class="string">'STL1'</span>
    <span class="string">'STL1_4state'</span>
    });

save(<span class="string">'example_1_CreateSSITModels'</span>,saveNames{:})
</pre>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2025b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% SSIT/Examples/example_1_CreateSSITModels

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Section 2.1: Creating, Saving, and Loading Models in SSIT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Preliminaries:
% clear
% close all

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Ex(1): Create a simple Bursting Gene model in SSIT
%%  This model consists of 3 species: 
%   an inactive gene ('offGene'), an activated gene ('onGene'), and mRNA. 
%%  There are four reactions, each with a unique rate parameter: 
%   activation ('kon'), inactivation ('koff'), transcription ('kr'), 
%   and mRNA degradation ('gr')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Create an SSIT instance and call it 'Model':
Model = SSIT;    

% Set species names for bursting gene expression model:
Model.species = {'offGene';'onGene';'mRNA'}; 

% Set initial condition:
Model.initialCondition = [1;0;0];           

% Set stoichiometry of reactions:
Model.stoichiometry = [-1,1,0,0;...
                        1,-1,0,0;...
                        0,0,1,-1]; 

% Set propensity functions:
Model.propensityFunctions = {'kon * offGene';'koff * onGene';...
                             'kr * onGene';'dr * mRNA'}; 

% Set initial guesses for parameters:
Model.parameters = ({'kon',0.2; 'koff',0.2; 'kr',10; 'dr',5});

% Print a summary of STL1 Model:
Model.summarizeModel

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Ex(2): Copy the Bursting Gene Model above to a new model, 'STL1'.  
% The species, reactions, and stochiometries remain the same; 
% however, a change is made to the propensity for the first reaction 
% (gene activation) so that its rate is controlled by a time-varying 
% MAPK input signal. As a result, new parameters must also be added.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Create a copy of the simple Bursting Gene model from above:
STL1 = Model;

% Update propensity function for the gene activation reaction:
STL1.propensityFunctions{2} = 'onGene*koff/(1+Hog1)';

% Define a simplified time-varying TF/MAPK input signal:
STL1.inputExpressions = {'Hog1','(a0+a1*exp(-r1*t)*(1-exp(-r2*t))*(t>0))'};

% Add the new parameters from the TF/MAPK input signal:
STL1.parameters = ({'kon',0.2; 'koff',0.2; 'kr',10; 'dr',5;...
                    'a0',5; 'a1',10; 'r1',0.004; 'r2',.01}); 

% Print a summary of STL1 Model:
STL1.summarizeModel

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Ex(3): Copy the 'STL1' model for 4-(gene)-state dynamics.  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Create a copy of the STL1 model from above:
STL1_4state = STL1;

% Set species names for STL1_4state:
STL1_4state.species = {'g1';'g2';'g3';'g4';'mRNA'};

% Set initial condition:
STL1_4state.initialCondition = [1;0;0;0;0];  

% Set stoichiometry of reactions:
STL1_4state.stoichiometry = [-1,1,0,0,0,0,0,0,0,0,0;...   % gene state 1
                              1,-1,-1,1,0,0,0,0,0,0,0;... % gene state 2
                              0,0,1,-1,-1,1,0,0,0,0,0;... % gene state 3        
                              0,0,0,0,1,-1,0,0,0,0,0;...  % gene state 4
                              0,0,0,0,0,0,1,1,1,1,-1]     % mRNA
                 % Reactions: 1,2,3,4,5,6,7,8,9,10,11

% Add a lag to the time-varying TF/MAPK input signal:
STL1_4state.inputExpressions = ...
    {'Hog1','A*(((1-(exp(1)^(-r1*(t-t0))))*exp(1)^(-r2*(t-t0)))/(1+((1-(exp(1)^(-r1*(t-t0))))*exp(1)^(-r2*(t-t0)))/M))^n*(t>t0)'};

% Set propensity functions:
STL1_4state.propensityFunctions = {...
          'k12*g1';'(max(0,k21o*(1-k21i*Hog1)))*g2';...
          'k23*g2';'k32*g3'; 'k34*g3';'k43*g4';...
          'kr1*g1';'kr2*g2';'kr3*g3';'kr4*g4';'dr*mRNA'}; 

% Add the new parameters for the 4 state model:
STL1_4state.parameters = ({'t0',3.17; 'k12',78; 'k21o',1.92e+05;...
    'k21i',3200; 'k23',0.402; 'k34',7.8; 'k32',1.62;...
    'k43',2.28; 'dr',0.294; 'kr1',4.68e-02; 'kr2',0.72;...
    'kr3', 59.4; 'kr4', 3.24; 'r1',4.14e-03; 'r2',0.426;...
    'A',9.3e+09; 'M',6.4e-04; 'n',3.1});

% Print a summary of STL1 Model:
STL1_4state.summarizeModel

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Ex.(4) Load and modify a pre-set SSIT model

% Several simple models are already coded in SSIT and can be quickly 
% loaded and modified. Below are currently available SSIT models (2025). 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ModelChoice = 'BirthDeath';      % One species problem
% ModelChoice = 'CentralDogma';    % Two species problem
% ModelChoice = 'BurstingGene';    % Two species problem
% ModelChoice = 'ToggleSwitch';    % Two species problem 
%                                    (non-linear toggle switch)
% ModelChoice = 'ToggleSwitch2';   % Two species problem
% ModelChoice = 'CentralDogmaTV';  % Two species problem (mRNa and protein) 
%                                    with time-varying transcription rate
% ModelChoice = 'Repressilator';               % Three species problem
% ModelChoice = 'BurstingSpatialCentralDogma'; % Four species problem 
%                                            (gene state, nuclear mRNa, 
%                                            cytoplasmic mRNA, and protein)
ModelChoice = 'RepressilatorGenes'; % Nine species problem

% Let's load one of the pre-existing SSIT models:
RepGenes_Model = SSIT(ModelChoice);

% View a summary of the 'RepressilatorGenes' model:
RepGenes_Model.summarizeModel


%% Save the basic Bursting Gene model, simple STL1 model, and 4-state STL1 
%% model for later use:
saveNames = unique({'Model'
    'STL1'
    'STL1_4state'
    });
    
save('example_1_CreateSSITModels',saveNames{:})
##### SOURCE END #####
-->
</body>
</html>
